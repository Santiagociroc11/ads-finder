# ===== ADS FINDER PRO - PRODUCTION CONFIGURATION =====
# Optimized for 1000+ concurrent users
# Copy this file to .env and fill in your actual values

# ===== REQUIRED CREDENTIALS =====
# MongoDB connection string - Get from MongoDB Atlas
MONGO_URL=mongodb+srv://username:password@cluster.mongodb.net/

# Facebook Access Token - Get from Facebook Developers
FACEBOOK_ACCESS_TOKEN=YOUR_FACEBOOK_ACCESS_TOKEN_HERE

# Google Gemini AI API Key - Get from Google AI Studio
GEMINI_API_KEY=YOUR_GEMINI_API_KEY_HERE

# Apify API Token - Get from Apify Console
APIFY_API_TOKEN=YOUR_APIFY_API_TOKEN_HERE

# ===== SECURITY =====
# JWT Secret - Use a strong, random string (min 64 characters)
JWT_SECRET=your_super_secure_jwt_secret_minimum_64_characters_for_production_security

# ===== PRODUCTION SETTINGS =====
NODE_ENV=production
PORT=3000
FRONTEND_URL=https://your-domain.com

# ===== DATABASE OPTIMIZATION =====
DB_NAME=adFinder
MONGO_MAX_POOL_SIZE=50
MONGO_MIN_POOL_SIZE=5
MONGO_IDLE_TIME=30000
MONGO_SOCKET_TIMEOUT=45000
MONGO_CONNECT_TIMEOUT=10000

# ===== RATE LIMITING (CRITICAL FOR 1000 USERS) =====
# Search endpoints - Most restrictive
SEARCH_RATE_LIMIT=200         # 200 searches per 15 minutes per user
SEARCH_WINDOW_MS=900000      # 15 minutes

# AI suggestions - Expensive API calls
AI_RATE_LIMIT=200             # 200 AI requests per 15 minutes per user
AI_WINDOW_MS=900000          # 15 minutes

# Scraping - Very expensive operations
SCRAPING_RATE_LIMIT=500        # 500 scraping requests per hour per user
SCRAPING_WINDOW_MS=3600000   # 1 hour

# General API - Catch-all protection
API_RATE_LIMIT=200           # 200 requests per minute per user
API_WINDOW_MS=60000          # 1 minute

# ===== CACHE CONFIGURATION =====
# Cache TTL in seconds - Optimized for cost savings
SEARCH_CACHE_TTL=3600        # 1 hour - Reduces Facebook API calls
STATS_CACHE_TTL=1800         # 30 minutes - Reduces expensive scraping
AI_CACHE_TTL=86400           # 24 hours - Reduces Gemini API costs

# Cache limits - Memory management
MAX_SEARCH_CACHE=1000        # Max 1000 cached searches
MAX_STATS_CACHE=500          # Max 500 advertiser stats
MAX_AI_CACHE=200             # Max 200 AI suggestions

# ===== BROWSER POOL (CRITICAL FOR SCRAPING) =====
MAX_BROWSERS=3               # Max concurrent browsers (RAM limit)
BROWSER_IDLE_TIME=300000     # 5 minutes - Close idle browsers
BROWSER_LIFE_TIME=1800000    # 30 minutes - Max browser lifetime
BROWSER_CLEANUP_INTERVAL=120000  # 2 minutes - Cleanup frequency

# ===== PERFORMANCE MONITORING =====
ENABLE_MONITORING=true
LOG_LEVEL=info
SLOW_REQUEST_THRESHOLD=5000  # 5 seconds
HIGH_MEMORY_THRESHOLD=85     # 85% memory usage warning
CRITICAL_MEMORY_THRESHOLD=90 # 90% memory usage critical

# ===== SECURITY HEADERS =====
ENABLE_CORS=true
CORS_ORIGIN=https://your-domain.com
TRUST_PROXY=false            # Set to true if behind proxy/load balancer

# ===== EXTERNAL API LIMITS =====
# Facebook API - Official limits
FACEBOOK_API_CALLS_PER_HOUR=200      # Per access token
FACEBOOK_API_TIMEOUT=30000           # 30 seconds

# Gemini AI - Rate limits
GEMINI_API_CALLS_PER_MINUTE=60       # Per API key
GEMINI_API_TIMEOUT=30000             # 30 seconds

# Apify - Cost management
APIFY_DEFAULT_TIMEOUT=300000         # 5 minutes
APIFY_MAX_CONCURRENT=2               # Max 2 Apify jobs simultaneously

# ===== HEALTH CHECK =====
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30000          # 30 seconds
MEMORY_WARNING_THRESHOLD=80          # 80% memory usage
RESPONSE_TIME_WARNING=2000           # 2 seconds average response time

# ===== GRACEFUL SHUTDOWN =====
GRACEFUL_SHUTDOWN_TIMEOUT=30000      # 30 seconds to close connections
FORCE_SHUTDOWN_TIMEOUT=45000         # 45 seconds before force exit

# ===== BACKUP & MAINTENANCE =====
AUTO_CLEANUP_ENABLED=true
CLEANUP_INTERVAL=3600000             # 1 hour
OLD_SEARCHES_RETENTION_DAYS=30       # Keep searches for 30 days
OLD_STATS_RETENTION_HOURS=48         # Keep stats for 48 hours

# ===== FEATURE FLAGS =====
ENABLE_APIFY_SCRAPING=true
ENABLE_AI_SUGGESTIONS=true
ENABLE_WEB_SCRAPING=true
ENABLE_ADVERTISER_STATS=true
ENABLE_AUTO_SAVE_SEARCHES=true

# ===== DEPLOYMENT INFO =====
APP_VERSION=2.0.0
BUILD_DATE=2025-09-20
DEPLOYMENT_ENV=production
SUPPORT_EMAIL=support@adsfinderpro.com

# ===== ALERTS & NOTIFICATIONS =====
ENABLE_SLACK_ALERTS=false           # Set to true for production alerts
SLACK_WEBHOOK_URL=                  # Your Slack webhook URL (optional)
ALERT_ON_HIGH_MEMORY=true
ALERT_ON_HIGH_ERROR_RATE=true
ALERT_ON_SLOW_RESPONSES=true

# ===== DEVELOPMENT OVERRIDES =====
# Uncomment these for development (less restrictive)
# SEARCH_RATE_LIMIT=100
# AI_RATE_LIMIT=50
# SCRAPING_RATE_LIMIT=20
# MAX_BROWSERS=5
# LOG_LEVEL=debug

# ===== TEST VARIABLES =====
# For testing environment variable loading
TEST_VARIABLE=TESTING_ENV_LOADING_123